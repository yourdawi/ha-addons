# Pi-hole (Home Assistant Add-on)

Run the official Pi-hole Docker image as a Home Assistant add-on.

Upstream project: https://github.com/pi-hole/docker-pi-hole

## Features
- Persistent data under `/config/pihole` (mapped to `/etc/pihole` and optionally `/etc/dnsmasq.d`)
- Configuration via add-on options mapped to Pi-hole environment variables
- Optional DHCP and NTP support

## Configuration
Options (`config.yaml`):
- `tz` (str): Time zone, e.g., `Europe/Berlin`
- `web_password` (str?, optional): Admin password for the web UI. If not set, Pi-hole generates a random one (see add-on logs).
- `dns_listening_mode` (list): `all` | `local` | `single`
- `enable_dhcp` (bool, optional): Enable DHCP server (opens port 67/udp)
- `enable_ntp` (bool, optional): Enable NTP (opens port 123/udp)
- `persist_dnsmasq_d` (bool, optional): Persist `/etc/dnsmasq.d` (useful for v5→v6 migration/custom configs)
- `log_level` (error|warn|info|debug)

## Network and ports
Default ports:
- 53/tcp, 53/udp – DNS
- 80/tcp – HTTP Web UI
- 443/tcp – HTTPS (self-signed cert generated by FTL)
Optional ports (only if respective feature enabled):
- 67/udp – DHCP server (requires `enable_dhcp=true` and capability NET_ADMIN)
- 123/udp – NTP (`enable_ntp=true`)

Note: Port 53 commonly conflicts with host/system DNS. Ensure no other service is bound to port 53.

## Persistence
- `/config/pihole/etc-pihole` → `/etc/pihole`
- `/config/pihole/etc-dnsmasq.d` → `/etc/dnsmasq.d`

## Known limitations
- Some Pi-hole functions require additional Linux capabilities (e.g., DHCP: NET_ADMIN, NTP: SYS_TIME). Capabilities are declared statically in `config.yaml` under `privileged`.
- Host network is disabled by default (`host_network: false`). If broadcast/multicast features don’t work as expected, you can consider enabling host networking (mind potential port conflicts).

## License
Pi-hole is a registered trademark. This add-on simply packages the official container image for Home Assistant.
